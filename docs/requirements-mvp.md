# 공연 티켓팅 플랫폼 MVP 요구사항 명세서

> **버전:** 2025-05-25

---

## 1. 사용자 관리 기능

### 1.1 회원가입 및 인증

* 사용자 등록 (이름, 이메일, 비밀번호, 연락처)
    * 이메일은 중복 불가
    * 비밀번호는 최소 8자 이상, 영문/숫자/특수문자 조합
    * 연락처는 010-XXXX-XXXX 형식, 중복 불가
* 로그인/로그아웃 (JWT 기반 토큰 인증)
    * 로그인 성공 시 JWT 토큰 발급
    * 토큰은 access token과 refresh token으로 분리
    * 토큰 만료시간은 access token 30분, refresh token 14일
* 역할 기반 권한 (일반 사용자, 관리자)

### 1.2 사용자 프로필 관리

* 개인정보 조회 (마이페이지)
    * 사용자 이름, 이메일, 연락처 조회
* 개인정보 수정
    * 이름, 연락처, 비밀번호 수정 가능

---

## 2. 공연 정보 관리 기능

### 2.1 공연 목록/상세

* 공연 목록 조회 (카테고리, 장소, 날짜 기준)

  * 썸네일/제목/일시/장소, 페이지네이션(기본: 최신순,이름순)
    * 일시는 YYYY년 MM월 DD일 형식
    * 일시는 시작일시와 종료일시로 구분
    * 단일(1번만 공연) 공연은 시작일시와 종료일시 동일
* 공연 상세 정보
    * 제목, 장소 이름, 장르명, 러닝타임, 공연 시작 일시, 공연 종료 일시, 티켓팅 시작 일시분, 티켓팅 종료 일시분
    * 공연은 여러번 진행될 수 있음 ex) 25년 5월 23일 20:00, 25년 5월 24일 19:00, 25년 5월 25일 18:00
    * 공연 일정을 달력에서 확인 가능
* 좌석 정보 및 예매 가능 여부 표시 (잔여석/등급/가격)
    * 좌석은 공연별로 별도의 등급 및 가격 설정 가능'
    * 좌석 등급은 모든 회차가 공유

### 2.2 공연 검색·필터

* 공연명 키워드 검색(부분 일치)
* 장르/장소/가격대 필터, 정렬(최신/이름)

---

## 3. 예매 프로세스

### 3.1 좌석 선택

* 공연 상세 화면에서 접근 가능
    * 달력에서 선택한 공연 일정을 클릭 시 좌석 선택 화면으로 이동
* 공연별 좌석 배치도(등급별 색상, 시각화)
* 예매 가능/불가 좌석 실시간 구분(완료/선택불가 표시)
* 좌석 선택은 인당 1개만 가능

### 3.2 좌석 예매 관리

* 좌석 예매 상태 실시간 업데이트
* 좌석 예매 시 다른 사용자는 해당 좌석 선택 불가
    * 좌석 예매 시도시 해당 좌석 상태를 대기중으로 변경
    * 대기중 또는 예매중 상태의 좌석은 다른 사용자가 선택 불가
* 좌석 예매 시간 제한(10분 이내 결제 필수, 결제 실패시 자동 해제)
    * 제한 시간 내에 결제 성공한 경우 좌석 상태를 예매중으로 변경

---

## 4. 결제 기능

### 4.1 결제 프로세스

* 결제 정보 입력 및 수단 선택(신용카드, 간편결제)
* 결제 금액 계산(좌석금액, 수수료/할인 적용)

### 4.2 결제 처리/취소

* 결제 게이트웨이(Toss) 연동, 승인/실패 응답처리
    * 결제 승인 시 좌석 상태를 예매중으로 변경
    * 결제 취소 시 좌석 상태를 대기중으로 변경
    * 전체취소/환불만 지원
* 결제 완료 시 예매 확정/영수증 발급(이메일/화면)
* 결제 실패/오류 시 롤백(좌석 자동 해제)

---

## 5. 예매 관리

### 5.1 예매 내역/상세

* 사용자별 예매 목록
    * 최근 1년간 예매 내역 조회
    * 예매일, 예매 번호, 공연 제목, 공연 일시
    * 예매일, 공연명 기준 정렬
* 예매 내역 상세 조회
    * 예매한 공연 목록, 상세 정보 조회
    * 예매 번호, 예매일, 좌석 등급, 좌석 번호, 가격, 공연 이름, 공연 썸네일, 장소 이름, 공연 일시 등

### 5.2 예매 취소

* 공연 시작 24시간 전까지 취소 가능(이후 취소 불가 안내)
* 취소 처리(좌석상태 대기중으로 변경, 결제 환불 연동)

---

## 6. 장애/운영/관측성

* 예매/결제 실패/중복에러/락충돌 등 주요 이벤트 로깅 및 알림
* 예매/결제 성공/실패율, 좌석 중복/락 실패율 등 메트릭 수집
* 장애/예외 발생시 자동 롤백 및 Alert Rule 운영
* 정책/PG/외부 연동 변경 등은 Feature Flag, 정책 테이블화
* 트레픽 과부하로 인한 서버 다운 방지 필요
    * rate limit 고려
---

## 7. 공통 사항
* 모든 시간값의 기준은 서버의 시간값 기준
    * 시간대는 UTC로 통일
    * 시간값 동기화는 google NTP 서버 사용

> 본 명세서는 "시장 검증 + 초기 운영 안정성"에 초점을 둔 최소 요구사항(MVP) 기준으로 작성되었으며,
> 모든 고도화/확장 기능은 실서비스 반응 및 운영 데이터 기반으로 순차 반영합니다.
