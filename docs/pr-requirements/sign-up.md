## 기능 명세서
### 1. 기능 정의

1.1. 기능명

- 회원가입 기능

1.2. 기능 설명 (요약)

- 사용자가 서비스에 가입할 수 있는 회원가입 기능을 구현
- 사용자는 이름, 이메일, 비밀번호, 연락처를 입력하여 계정을 생성 가능
- 이름 중복 확인, 이메일 중복 확인, RFC 5322를 준수하는 이메일 형식 검증, 비밀번호 강도 확인, 연락처 유효성 검사 및 중복 확인을 통해 유효한 사용자 정보만 등록되도록 함.
- 기본적으로 회원가입을 통해 만들어진 회원의 권한은 `USER`임.

### 2. 개발 배경 및 목표

2.1. 현황 및 문제점 (AS-IS)

- 현재 서비스에는 회원가입 기능이 구현되어 있지 않아 사용자 서비스 이용 불가.
- 사용자 인증 및 권한 관리를 위한 기본적인 회원 시스템 필요.

2.2. 개선 방향 및 기대 효과 (TO-BE)

- 사용자 친화적인 회원가입 프로세스 구현으로 서비스 진입 장벽을 낮춤.
- 보안 요구사항을 충족하는 안전한 사용자 인증 시스템 구축.
- 사용자 데이터를 체계적으로 관리하여 향후 개인화된 서비스 제공의 기반 마련.

2.3. 핵심 목표

- 사용자가 쉽고 빠르게 회원가입을 완료할 수 있는 UI/UX 제공
- 안전한 비밀번호 관리 및 사용자 정보 보호
- 이메일 중복 확인, 이메일 형식(RFC 5322 준수) 검증, 연락처 중복 및 유효성 검사를 통한 데이터 무결성 확보

### 3. 구현할 기능 목록 (체크리스트)

3.1. 사용자 관점 기능

- 회원가입 페이지 접근
- 사용자 정보 입력 (이름, 이메일, 비밀번호, 연락처)
- 회원가입 제출 시 자동으로 수행되는 검증:
  - 이메일 형식 검증 (RFC 5322 준수)
  - 이메일 중복 확인
  - 이름 중복 확인
  - 비밀번호 강도 확인 (최소 8자 이상, 대문자, 소문자, 숫자, 특수문자 포함)
  - 연락처 유효성 검사 (010-XXXX-XXXX 형식)
  - 연락처 중복 확인
- 회원가입 완료 후 로그인 페이지로 이동
- 회원가입 실패 시 적절한 오류 메시지 표시

3.2. 시스템 관점 기능

- 회원가입 요청 처리 시 내부적으로 수행되는 검증
    - 이메일 형식 검증 (RFC 5322 준수)
    - 이메일 중복 확인
    - 이름 중복 확인
    - 비밀번호 강도 확인 (최소 8자 이상, 대문자, 소문자, 숫자, 특수문자 포함)
    - 연락처 형식 검증 (010-XXXX-XXXX)
    - 연락처 중복 확인
- 비밀번호 암호화 저장
- 사용자 정보 데이터베이스 저장
- 회원가입 완료 시 기본 사용자 권한(USER) 부여
- 계정 활성화 상태 관리 (기본 활성화)

3.3. 비기능적 요구사항 (체크리스트)

성능 요구사항:
- 회원가입 프로세스 완료 시간 3초 이내
- 동시에 100명 이상의 사용자가 회원가입을 진행해도 성능 저하 없음

보안:
- 비밀번호 암호화 저장 (BCrypt 등 안전한 해시 알고리즘 사용)
- 비밀번호 정책: 최소 8자 이상, 대문자, 소문자, 숫자, 특수문자를 포함
- 입력 데이터 검증을 통한 인젝션 공격 방지
- CSRF 보호 적용
- 이메일 중복 불가 처리
- 이름 중복 불가 처리
- 이메일 형식 검증 (RFC 5322 준수)
- 연락처 중복 불가 및 형식(010-XXXX-XXXX) 검증 처리

사용성:
- 모바일 환경에서도 사용 가능한 반응형 디자인
- 입력 오류 시 즉각적인 피드백 제공
- 회원가입 과정이 3단계 이내로 간소화

신뢰성:
- 회원가입 중 오류 발생 시 사용자 데이터 손실 방지
- 시스템 장애 시 복구 방안 마련

### 4. 상세 설계

4.1. 화면 흐름 및 UI/UX (해당되는 경우)

1. 회원가입 페이지
   - 사용자 정보 입력 폼 (이름, 이메일, 비밀번호, 비밀번호 확인, 연락처)
   - 회원가입 제출 버튼 (제출 시 모든 검증이 자동으로 이루어짐)
   - 로그인 페이지로 이동 링크

2. 회원가입 완료 페이지
   - 회원가입 성공 메시지
   - 로그인 페이지로 이동 버튼

주요 변경점:
- 회원가입 페이지 신규 개발
- 회원가입 완료 페이지 신규 개발

4.2. 데이터 모델 (해당되는 경우)

테이블/컬렉션 변경 사항:
- 기존 User 엔티티 활용
  - `email` 필드: `unique` 제약 조건, RFC 5322 준수 형식 검증 로직 추가
  - `phone` 필드: `unique` 제약 조건, `010-XXXX-XXXX` 형식 검증 로직 추가
  - `password` 필드: 최소 8자 이상, 대문자, 소문자, 숫자, 특수문자 포함 유효성 검사 로직 추가
  - `role` 필드: 기본값 `USER`로 설정

새로운 데이터 구조:
- x

4.3. API 설계 (해당되는 경우)

1.  회원가입 API
    -   엔드포인트: `/api/v1/users/sign-up`
    -   메서드: POST
    -   설명: 회원가입 요청 시 내부적으로 이메일 형식 검증, 이메일 중복 확인, 이름 중복 확인, 비밀번호 강도 확인, 연락처 형식 검증, 연락처 중복 확인 등 모든 검증이 자동으로 이루어집니다. 별도의 중복 확인 API 호출이 필요하지 않습니다.
    -   요청 본문:
        ```json
        {
          "username": "string",
          "email": "string",
          "password": "string",
          "phone": "string"
        }
        ```
    - curl 명령 예시
        ```bash
        curl -X POST http://localhost:8080/api/v1/users/sign-up \
        -H "Content-Type: application/json" \
        -d '{
            "username": "testUser",
            "email": "test@example.com",
            "password": "Password123!",
            "phone": "010-1234-5678"
        }'
        ```
        -   실패 - 유효성 검사 오류 (HTTP 400 Bad Request):
            -   예시 1: 이메일 형식 오류
                ```json
                {
                  "status": "CONSTRAINT_VIOLATION",
                  "message": "이메일 형식이 올바르지 않습니다."
                }
                ```
            -   예시 2: 비밀번호 강도 부족
                ```json
                {
                  "status": "CONSTRAINT_VIOLATION",
                  "message": "비밀번호는 최소 8자 이상, 대문자, 소문자, 숫자, 특수문자를 포함해야 합니다."
                }
                ```
            -   예시 3: 필수 필드 누락 (이름)
                ```json
                {
                  "status": "CONSTRAINT_VIOLATION",
                  "message": "이름을 입력해주세요."
                }
                ```
        -   실패 - 중복된 정보 (HTTP 400 Bad Request):
            -   예시 1: 이미 등록된 이메일
                ```json
                {
                  "status": "EMAIL-001",
                  "message": "이미 사용중인 이메일입니다."
                }
                ```
            -   예시 2: 이미 등록된 이름
                ```json
                {
                  "status": "EMAIL-002",
                  "message": "중복된 이름입니다."
                }
                ```
            -   예시 3: 이미 등록된 연락처
                ```json
                {
                  "status": "EMAIL-003",
                  "message": "이미 사용중인 연락처입니다."
                }
                ```

### 5. 개발 및 테스트 체크리스트

5.1. 개발 항목
- [x] 회원가입 요청은 성공적으로 처리된다
- [x] 회원가입 성공 시 정의된 성공 코드를 반환한다
- [x] 비밀번호는 안전하게 암호화되어 데이터베이스에 저장된다
- [x] 회원 정보는 요청된 내용과 동일하게 데이터베이스에 저장된다
- [x] 이메일이 RFC 5322 형식을 만족하지 않은 경우 CONSTRAINT_VIOLATION이 응답된다
- [x] 중복된 이메일로 가입 시 에러 코드 USER_006를 반환한다
- [x] 중복된 이름으로 가입 시 에러 코드 USER_002를 반환한다
- [x] 비밀번호는 최소 8자 이상 대문자 소문자 숫자 특수문자를 포함해야 한다
- [x] 연락처는 010-XXXX-XXXX 형식이어야 한다
- [x] 중복된 연락처로 가입 시 에러 코드 USER-005를 반환한다
- [x] 회원가입 페이지는 모든 필수 입력 필드를 포함한다
- [x] 회원가입 성공 시 사용자에게 명확한 완료 피드백을 제공한다

### 6. 주요 고려사항 및 위험 요소

- 비밀번호 보안: 안전한 암호화 알고리즘 사용 및 비밀번호 정책 (최소 8자 이상, 대문자, 소문자, 숫자, 특수문자 포함) 강제
- 이메일 유효성: RFC 5322를 준수하는 정규 표현식 또는 라이브러리를 사용하여 정확한 이메일 형식 검증
- 연락처 유효성: `010-XXXX-XXXX` 형식에 대한 정확한 검증

### 7. 범위 외 항목

- 소셜 로그인 연동
- 이메일 인증을 통한 계정 활성화
- 비밀번호 찾기/재설정 기능
- 회원 탈퇴 기능
- 관리자용 사용자 관리 기능 (회원 정보 조회/수정/삭제)

### 8. 참고 자료

- Spring Security 공식 문서: https://docs.spring.io/spring-security/reference/index.html
- RFC 5322: https://datatracker.ietf.org/doc/html/rfc5322
